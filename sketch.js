// Generated by CoffeeScript 2.7.0
var S, draw, echo, mouseReleased, setup, start, startNewGame, touchEnded, touchStarted, touching;

touching = false;

touchStarted = function() {
  touching = true;
  return false;
};

touchEnded = function() {
  touching = false;
  return false;
};

mouseReleased = function() {
  return touching = false;
};

echo = console.log;

S = {
  x: 0,
  y: 0,
  level: 0,
  d: 50,
  stars: []
};

start = new Date();

startNewGame = function(rand = false) {
  start = new Date();
  if (rand) {
    S.stars = range(height * width / S.d / S.d).map(function(i) {
      return [width * random(), height * random()];
    });
  }
  return Object.assign(S, {
    level: S.level,
    x: 0,
    y: height / 2
  });
};

draw = function() {
  var j, k, len, len1, ref, ref1, ref2, x, y;
  bg(0.5);
  fill('red');
  sc();
  text(S.level, width / 2, height / 2);
  fill('yellow');
  ref = S.stars;
  for (j = 0, len = ref.length; j < len; j++) {
    [x, y] = ref[j];
    circle(x, y, S.level);
  }
  rect(width - 3, 0.4 * height, 2, 0.2 * height);
  if (mouseIsPressed && 0.1 * height > dist(mouseX, mouseY, 0, 0)) {
    startNewGame(true);
  }
  [S.x, S.y] = [S.x + 1, S.y + (mouseIsPressed || keyIsDown(32) ? 1 : -1)];
  sc(0);
  line(S.x, S.y, S.x + 500, S.y + 500);
  line(S.x, S.y, S.x + 500, S.y - 500);
  if (S.x > width && (0.4 * height < (ref1 = S.y) && ref1 < 0.6 * height)) {
    S.level++;
    localStorage.stardodge = JSON.stringify({
      level: S.level,
      lastUsed: new Date()
    });
    echo('saved', localStorage.stardodge);
    start = new Date();
    return startNewGame(true);
  }
  if (S.y < 0 || S.y > height || S.x > width) {
    return startNewGame(false);
  }
  ref2 = S.stars;
  for (k = 0, len1 = ref2.length; k < len1; k++) {
    [x, y] = ref2[k];
    if (S.level > dist(S.x, S.y, x, y)) {
      return startNewGame(false);
    }
  }
};

setup = function() {
  var millis, value;
  createCanvas(windowWidth, windowHeight);
  value = localStorage.stardodge;
  if (value === void 0 || value === null || value === 'null') {
    value = {
      level: 1,
      lastUsed: new Date()
    };
  } else {
    value = JSON.parse(value);
  }
  echo('loaded', value);
  millis = new Date() - new Date(value.lastUsed);
  if (millis > 24 * 60 * 60 * 1000) {
    value.level = 1;
  }
  S.level = value.level;
  textAlign(CENTER, CENTER);
  textSize(height);
  return startNewGame(true);
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2tldGNoLmpzIiwic291cmNlUm9vdCI6IlxcIiwic291cmNlcyI6WyJza2V0Y2guY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxJQUFBLENBQUEsRUFBQSxJQUFBLEVBQUEsSUFBQSxFQUFBLGFBQUEsRUFBQSxLQUFBLEVBQUEsS0FBQSxFQUFBLFlBQUEsRUFBQSxVQUFBLEVBQUEsWUFBQSxFQUFBOztBQUFBLFFBQUEsR0FBVzs7QUFDWCxZQUFBLEdBQWUsUUFBQSxDQUFBLENBQUE7RUFBRyxRQUFBLEdBQVc7U0FBTTtBQUFwQjs7QUFDZixVQUFBLEdBQWEsUUFBQSxDQUFBLENBQUE7RUFBRyxRQUFBLEdBQVc7U0FBTztBQUFyQjs7QUFDYixhQUFBLEdBQWdCLFFBQUEsQ0FBQSxDQUFBO1NBQUcsUUFBQSxHQUFXO0FBQWQ7O0FBRWhCLElBQUEsR0FBTyxPQUFPLENBQUM7O0FBRWYsQ0FBQSxHQUFJO0VBQUMsQ0FBQSxFQUFFLENBQUg7RUFBTSxDQUFBLEVBQUUsQ0FBUjtFQUFXLEtBQUEsRUFBTSxDQUFqQjtFQUFvQixDQUFBLEVBQUUsRUFBdEI7RUFBMEIsS0FBQSxFQUFNO0FBQWhDOztBQUNKLEtBQUEsR0FBUSxJQUFJLElBQUosQ0FBQTs7QUFFUixZQUFBLEdBQWUsUUFBQSxDQUFDLE9BQU8sS0FBUixDQUFBO0VBQ2QsS0FBQSxHQUFRLElBQUksSUFBSixDQUFBO0VBQ1IsSUFBRyxJQUFIO0lBQWEsQ0FBQyxDQUFDLEtBQUYsR0FBVSxLQUFBLENBQU0sTUFBQSxHQUFPLEtBQVAsR0FBYSxDQUFDLENBQUMsQ0FBZixHQUFpQixDQUFDLENBQUMsQ0FBekIsQ0FBMkIsQ0FBQyxHQUE1QixDQUFnQyxRQUFBLENBQUMsQ0FBRCxDQUFBO2FBQU8sQ0FBQyxLQUFBLEdBQU0sTUFBQSxDQUFBLENBQVAsRUFBaUIsTUFBQSxHQUFPLE1BQUEsQ0FBQSxDQUF4QjtJQUFQLENBQWhDLEVBQXZCOztTQUNBLE1BQU0sQ0FBQyxNQUFQLENBQWMsQ0FBZCxF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LFFBQUEsQ0FBQSxDQUFBO0FBQ1IsTUFBQSxNQUFBLEVBQUE7RUFBQyxZQUFBLENBQWEsV0FBYixFQUF5QixZQUF6QjtFQUNBLEtBQUEsR0FBUSxZQUFZLENBQUM7RUFDckIsSUFBRyxLQUFBLEtBQVMsTUFBVCxJQUFzQixLQUFBLEtBQVMsSUFBL0IsSUFBdUMsS0FBQSxLQUFTLE1BQW5EO0lBQStELEtBQUEsR0FBUTtNQUFDLEtBQUEsRUFBTyxDQUFSO01BQVcsUUFBQSxFQUFXLElBQUksSUFBSixDQUFBO0lBQXRCLEVBQXZFO0dBQUEsTUFBQTtJQUNLLEtBQUEsR0FBUSxJQUFJLENBQUMsS0FBTCxDQUFXLEtBQVgsRUFEYjs7RUFFQSxJQUFBLENBQUssUUFBTCxFQUFjLEtBQWQ7RUFDQSxNQUFBLEdBQVMsSUFBSSxJQUFKLENBQUEsQ0FBQSxHQUFhLElBQUksSUFBSixDQUFTLEtBQUssQ0FBQyxRQUFmO0VBQ3RCLElBQUksTUFBQSxHQUFTLEVBQUEsR0FBSyxFQUFMLEdBQVUsRUFBVixHQUFlLElBQTVCO0lBQXNDLEtBQUssQ0FBQyxLQUFOLEdBQWMsRUFBcEQ7O0VBQ0EsQ0FBQyxDQUFDLEtBQUYsR0FBVSxLQUFLLENBQUM7RUFDaEIsU0FBQSxDQUFVLE1BQVYsRUFBaUIsTUFBakI7RUFDQSxRQUFBLENBQVMsTUFBVDtTQUNBLFlBQUEsQ0FBYSxJQUFiO0FBWE8iLCJzb3VyY2VzQ29udGVudCI6WyJ0b3VjaGluZyA9IGZhbHNlXHJcbnRvdWNoU3RhcnRlZCA9IC0+IHRvdWNoaW5nID0gdHJ1ZTsgZmFsc2VcclxudG91Y2hFbmRlZCA9IC0+IHRvdWNoaW5nID0gZmFsc2U7IGZhbHNlXHJcbm1vdXNlUmVsZWFzZWQgPSAtPiB0b3VjaGluZyA9IGZhbHNlXHJcblxyXG5lY2hvID0gY29uc29sZS5sb2dcclxuXHJcblMgPSB7eDowLCB5OjAsIGxldmVsOjAsIGQ6NTAsIHN0YXJzOltdfVxyXG5zdGFydCA9IG5ldyBEYXRlXHJcblxyXG5zdGFydE5ld0dhbWUgPSAocmFuZCA9IGZhbHNlKSAtPlxyXG5cdHN0YXJ0ID0gbmV3IERhdGUoKVxyXG5cdGlmIHJhbmQgdGhlbiBTLnN0YXJzID0gcmFuZ2UoaGVpZ2h0KndpZHRoL1MuZC9TLmQpLm1hcCgoaSkgLT4gW3dpZHRoKnJhbmRvbSgpLCBoZWlnaHQqcmFuZG9tKCldKVxyXG5cdE9iamVjdC5hc3NpZ24gUyx7bGV2ZWw6Uy5sZXZlbCwgeDowLCB5OmhlaWdodC8yfVxyXG5cclxuZHJhdyA9IC0+XHJcblx0YmcgMC41XHJcblxyXG5cdGZpbGwgJ3JlZCdcclxuXHRzYygpXHJcblx0dGV4dCBTLmxldmVsLCB3aWR0aC8yLCBoZWlnaHQvMlxyXG5cclxuXHRmaWxsICd5ZWxsb3cnXHJcblx0Y2lyY2xlIHgseSxTLmxldmVsIGZvciBbeCx5XSBpbiBTLnN0YXJzIFxyXG5cclxuXHRyZWN0IHdpZHRoLTMsMC40KmhlaWdodCwyLDAuMipoZWlnaHRcclxuXHJcblx0aWYgbW91c2VJc1ByZXNzZWQgYW5kIDAuMSpoZWlnaHQgPiBkaXN0IG1vdXNlWCxtb3VzZVksIDAsMCB0aGVuIHN0YXJ0TmV3R2FtZSB0cnVlXHJcblx0XHJcblx0W1MueCxTLnldID0gW1MueCsxLCBTLnkgKyBpZiBtb3VzZUlzUHJlc3NlZCBvciBrZXlJc0Rvd24gMzIgdGhlbiAxIGVsc2UgLTFdXHJcblx0c2MgMFxyXG5cclxuXHRsaW5lIFMueCwgUy55LCBTLnggKyA1MDAsIFMueSArIDUwMFxyXG5cdGxpbmUgUy54LCBTLnksIFMueCArIDUwMCwgUy55IC0gNTAwXHJcblxyXG5cdGlmIFMueCA+IHdpZHRoIGFuZCAwLjQqaGVpZ2h0IDwgUy55IDwgMC42KmhlaWdodCBcclxuXHRcdFMuIGxldmVsKytcclxuXHRcdGxvY2FsU3RvcmFnZS5zdGFyZG9kZ2UgPSBKU09OLnN0cmluZ2lmeSB7bGV2ZWw6IFMubGV2ZWwsIGxhc3RVc2VkIDogbmV3IERhdGUoKX1cclxuXHRcdGVjaG8gJ3NhdmVkJyxsb2NhbFN0b3JhZ2Uuc3RhcmRvZGdlXHJcblx0XHRzdGFydCA9IG5ldyBEYXRlKClcclxuXHRcdHJldHVybiBzdGFydE5ld0dhbWUgdHJ1ZVxyXG5cdGlmIFMueSA8IDAgb3IgUy55ID4gaGVpZ2h0IG9yIFMueCA+IHdpZHRoIFxyXG5cdFx0cmV0dXJuIHN0YXJ0TmV3R2FtZSBmYWxzZVxyXG5cdGZvciBbeCx5XSBpbiBTLnN0YXJzXHJcblx0XHRpZiBTLmxldmVsID4gZGlzdCBTLngsUy55LCB4LHkgdGhlbiByZXR1cm4gc3RhcnROZXdHYW1lIGZhbHNlXHJcblxyXG5zZXR1cCA9IC0+XHJcblx0Y3JlYXRlQ2FudmFzIHdpbmRvd1dpZHRoLHdpbmRvd0hlaWdodFxyXG5cdHZhbHVlID0gbG9jYWxTdG9yYWdlLnN0YXJkb2RnZVxyXG5cdGlmIHZhbHVlID09IHVuZGVmaW5lZCBvciB2YWx1ZSA9PSBudWxsIG9yIHZhbHVlID09ICdudWxsJyB0aGVuIHZhbHVlID0ge2xldmVsOiAxLCBsYXN0VXNlZCA6IG5ldyBEYXRlKCl9XHJcblx0ZWxzZSB2YWx1ZSA9IEpTT04ucGFyc2UgdmFsdWVcclxuXHRlY2hvICdsb2FkZWQnLHZhbHVlXHJcblx0bWlsbGlzID0gbmV3IERhdGUoKSAtIG5ldyBEYXRlKHZhbHVlLmxhc3RVc2VkKVxyXG5cdGlmICBtaWxsaXMgPiAyNCAqIDYwICogNjAgKiAxMDAwIHRoZW4gdmFsdWUubGV2ZWwgPSAxXHJcblx0Uy5sZXZlbCA9IHZhbHVlLmxldmVsXHJcblx0dGV4dEFsaWduIENFTlRFUixDRU5URVJcclxuXHR0ZXh0U2l6ZSBoZWlnaHRcclxuXHRzdGFydE5ld0dhbWUgdHJ1ZVxyXG4iXX0=
//# sourceURL=c:\github\StarDodge\sketch.coffee